<% issue_params = {
  style: "summary",
  link_options: {
    title: { href: edit_document_path(@edition.document, anchor: "title") },
    summary: { href: edit_document_path(@edition.document, anchor: "summary") },
    body: { href: edit_document_path(@edition.document, anchor: "body") },
    change_note: { href: edit_document_path(@edition.document, anchor: "change-note") },
    alt_text: { href: "#lead-image" },
    credit: { href: "#lead-image" },
    caption: { href: "#lead-image" },
    topics: { href: update_topics_path(@edition.document) },
  }
} %>

<% unless @edition.revision_synced? %>
  <% draft_issues = Requirements::EditionChecker.new(@edition).pre_preview_issues %>

  <% if draft_issues.any? %>
    <% if flash[:tried_to_preview] %>
      <%= render "govuk_publishing_components/components/error_summary", {
        title: t("documents.show.flashes.pre_preview_issues.error"),
        items: draft_issues.items(issue_params),
      } %>
    <% else %>
      <%= render "/components/warning_summary", {
        title: t("documents.show.flashes.pre_preview_issues.warning"),
        items: draft_issues.items(issue_params),
      } %>
    <% end %>
  <% end %>
<% end %>

<% if @edition.status.draft? || @edition.status.submitted_for_review? %>
  <% publish_issues = Requirements::EditionChecker.new(@edition).pre_publish_issues %>

  <% if publish_issues.any? %>
    <% if flash[:tried_to_publish] %>
      <%= render "govuk_publishing_components/components/error_summary", {
        title: t("documents.show.flashes.pre_publish_issues.error"),
        items: publish_issues.items(issue_params),
      } %>
    <% else %>
      <%= render "/components/warning_summary", {
        title: t("documents.show.flashes.pre_publish_issues.warning"),
        items: publish_issues.items(issue_params),
      } %>
    <% end %>
  <% end %>
<% end %>
